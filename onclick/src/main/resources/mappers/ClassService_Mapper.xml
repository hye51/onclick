<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onclick.app.persistence.ClassService_Mapper">

<insert id="classInsert" parameterType="HashMap">
	<selectKey keyProperty="cidx" resultType="Integer" order="AFTER"> 
	SELECT ONCLICK_CIDX_SEQ.CURRVAL FROM onclick_class
	</selectKey>
	INSERT INTO onclick_class(cidx,cname,ccontents,cdate,csta,cfin,creyn,cweek,cseq,lidx,cnotyn)
	VALUES(
		ONCLICK_CIDX_SEQ.nextval, 
		#{cname},
		#{ccontents},
		sysdate,
		#{csta},
		#{cfin},
		#{creyn},
		#{cweek},
		(SELECT NVL(MAX(cseq),0)+1 FROM onclick_class where cweek=#{cweek}),
		#{lidx},
		#{cnotyn})
</insert>
	
<select id="classSelect" parameterType="Integer" resultType="cv">
SELECT *	
FROM onclick_class
WHERE lidx=#{lidx}
ORDER BY cweek, cseq
</select>
</mapper>